import os
import pickle

import torch

dirpath = os.path.dirname(os.path.realpath(__file__))
with open(os.path.join(dirpath, "..", "models", "hyperparams_dictionary.pkl"), 'rb') as f:
    args = pickle.load(f)

n_objects = 5  # 6#(6 body parts and 2 top and bottom reference points)
object_dim = 6
output_dim = 6
n_relations = 10  # 30#34#30#10
relation_dim = 3
external_effect_dim = 1
effect_dim = 50
# device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
# print(device,"device")
# USE_CUDA = torch.cuda.is_available() 
seed_val = args.seed_val
batch_size = 35
device = torch.device("cuda" if torch.cuda.is_available() else "mps" if torch.backends.mps.is_available() else "cpu")
print(f"Using device: {device}")
USE_CUDA = torch.cuda.is_available()
USE_MPS = torch.backends.mps.is_available()
model_type = args.model_type
split = args.split_identity

patience = 5
early_stopping = False

# inc_labels=['Feet Lifting off the ground','Not Folding Legs Together',\
#             'Not Lifting Knees off the ground','Pushing Youself up with arms']#,'b3','b4']#['b1']#['b2','b3','b6']#['b1','b2','b3','b4','b5','b6']
# inc_labels=['Feet Lifting off the ground','Pushing Youself up with arms']
inc_labels = ['leg', 'hand']

## n_obj=9
# coords_ids =[0,12,24,26,14,16]
# loss_id = {'ns':[],'rs':[],'rh':[],'rk':[],'re':[],  'rw':[], 'total':[]}
# keys = ['ns' ,'rs' ,'rh','rk' ,'re' , 'rw' ]

coords_ids = [i for i in range(33)]
keys = ["nose", "left eye inner", "left eye", "left eye outer", "right eye inner", "right eye", "right eye outer",
        "left ear", "right ear", "mouth left", "mouth right", "left shoulder", "right shoulder", "left elbow",
        "right elbow", "left wrist", "right wrist", "left pinky", "right pinky", "left index", "right index",
        "left thumb", "right thumb", "left hip", "right hip", "left knee", "right knee", "left ankle", "right ankle",
        "left heel", "right heel", "left foot index", "right foot index"]
POSE_CONNECTIONS = [(0, 1), (1, 2), (2, 3), (3, 7), (0, 4), (4, 5),

                    (5, 6), (6, 8), (9, 10), (11, 12), (11, 13),

                    (13, 15), (15, 17), (15, 19), (15, 21), (17, 19),

                    (12, 14), (14, 16), (16, 18), (16, 20), (16, 22),

                    (18, 20), (11, 23), (12, 24), (23, 24), (23, 25),

                    (24, 26), (25, 27), (26, 28), (27, 29), (28, 30),

                    (29, 31), (30, 32), (27, 31), (28, 32)]

# 0 - nose
# 1 - left eye (inner)
# 2 - left eye
# 3 - left eye (outer)
# 4 - right eye (inner)
# 5 - right eye
# 6 - right eye (outer)
# 7 - left ear
# 8 - right ear
# 9 - mouth (left)
# 10 - mouth (right)
# 11 - left shoulder
# 12 - right shoulder
# 13 - left elbow
# 14 - right elbow
# 15 - left wrist
# 16 - right wrist
# 17 - left pinky
# 18 - right pinky
# 19 - left index
# 20 - right index
# 21 - left thumb
# 22 - right thumb
# 23 - left hip
# 24 - right hip
# 25 - left knee
# 26 - right knee
# 27 - left ankle
# 28 - right ankle
# 29 - left heel
# 30 - right heel
# 31 - left foot index
# 32 - right foot index
# #  nose to hip
# receiver_rel =np.array(
# [[1., 0., 0., 0., 0., 0., 1., 0., 0., 0.,],
#  [0., 1., 1., 0., 0., 0., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 0., 0., 0., 1., 1., 0.,],
#  [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,],
#  [0., 0., 0., 1., 1., 0., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,]] )


# sender_rel =np.array(
# [[0., 1., 0., 0., 0., 0., 0., 1., 0., 0.,],
#  [1., 0., 0., 1., 0., 0., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 0., 0., 1., 0., 0., 1.,],
#  [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,],
#  [0., 0., 1., 0., 0., 1., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,]])

# shoulder to hip - with nose
# receiver_rel =np.array(
# [[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,],
#  [0., 1., 1., 0., 0., 0., 1., 0., 0., 0.,],
#  [0., 0., 0., 0., 0., 0., 0., 1., 1., 0.,],
#  [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.,],
#  [0., 0., 0., 1., 1., 0., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,]] )


# sender_rel =np.array(
# [[0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,],
#  [1., 0., 0., 1., 0., 0., 0., 1., 0., 0.,],
#  [0., 0., 0., 0., 0., 0., 1., 0., 0., 1.,],
#  [0., 0., 0., 0., 0., 0., 0., 0., 1., 0.,],
#  [0., 0., 1., 0., 0., 1., 0., 0., 0., 0.,],
#  [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,]])

# receiver_rel = np.array( [[1., 0., 1., 0., 1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
#   0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
#  [0., 1., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 1., 0., 1., 0.,
#   0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
#  [0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0.,
#   1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
#  [0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0.,
#   0., 1., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0.],
#  [0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0.,
#   0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 0.],
#  [0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
#   0., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 1.]] )
# sender_rel = np.array( [[0., 1., 0., 1., 0., 1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
#   0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
#  [1., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 1., 0., 1.,
#   0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
#  [0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0.,
#   0., 1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0.],
#  [0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
#   1., 0., 0., 0., 0., 0., 0., 1., 0., 1., 0., 0.],
#  [0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
#   0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0., 1.],
#  [0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0.,
#   0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 1., 0.]] )


# receiver_rel = np.array([
#                     [0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,], 
#                     [1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,],
#                     [0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,],
#                     [0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,],
#                     [0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,0,],
#                     ])

# sender_rel = np.array([
#                     [1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,],
#                     [0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,],
#                     [0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,],
#                     [0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,],
#                     [0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,],
#                     [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,],
#                     ])
